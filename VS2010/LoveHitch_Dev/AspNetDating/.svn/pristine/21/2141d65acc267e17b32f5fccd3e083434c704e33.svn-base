function showHeaderButton(){jQuery("td.facebookbtn").show()}function facebookLoginTry(){console.log("fb tries = "+fbTriesElapsed),fbTriesElapsed--;$.get("./handlers/SetSessionState.ashx",{key:"FacebookConnectTriesElapsed",val:fbTriesElapsed},function(){}),FB.getLoginStatus(function(n){var t,i;n.status=="connected"?(t="./LoginThroughFacebook.aspx?access_token="+n.authResponse.accessToken+"&fbUserID="+n.authResponse.userID+"&signed="+n.authResponse.signedRequest,fbUserIsAuthorized=!0,fbUserIsLoggedIn=!0,window!=window.top||top!==self?window.location=t:(i=n.authResponse.userID,FB.api("/me",function(n){i=n.name,jQuery("#fbLoginModal").html("<br>Are you "+i+" ? <br/><br/>Do you want to login with this facebook account ?"),jQuery("#fbLoginModal").dialog({resizable:!1,height:250,width:600,modal:!0,buttons:{"YES - Use Facebook":function(){$(this).dialog("close"),window.location=t},"NO - Logout from Facebook":function(){FB.logout(function(){}),$(this).dialog("close")},"CANCEL - Do Nothing":function(){$(this).dialog("close")}}})}))):FB.login(function(n){if(n.authResponse)if(n.authResponse.accessToken){var t="./LoginThroughFacebook.aspx?access_token="+n.authResponse.accessToken+"&fbUserID="+n.authResponse.userID+"&signed="+n.authResponse.signedRequest;fbUserIsAuthorized=!1,fbUserIsLoggedIn=!0,window!=window.top&&(window.location=t)}else window.location="./Login.aspx?facebook=0";else window.location="./Login.aspx?facebook=0"},{scope:fbBasicPermissionScope})})}function showResponse(n){var t="response.status = "+n.status+" \nresponse.authResponse.accessToken = "+n.authResponse.accessToken+"\nresponse.authResponse.userID = "+n.authResponse.userID;console.log(t)}function fbEnsureInit(n){window.fbApiInit?n&&n():setTimeout(function(){fbEnsureInit(n)},50)}var fbsdkIsLoaded=!1,fbIsInitialized=!1,fbUserIsLoggedIn=!1,fbUserIsAuthorized=!1;window.fbAsyncInit=function(){fbsdkIsLoaded=!0,FB.init({appId:facebookAppId,channelURL:"./Facebook/xd_receiver.htm",status:!0,cookie:!0,oauth:!0,frictionlessRequests:!0,xfbml:!0}),fbIsInitialized=!0;var n=Sys.UI.DomElement.getBounds($get("layout")).height;jQuery(function(){FB.Canvas.setSize({width:960,height:n+30}),FB.Canvas.setAutoGrow(1e3)}),FB.Canvas.setDoneLoading(),FB.Event.subscribe("xfbml.render",function(){window.setTimeout("showHeaderButton()",1e3)}),fbTriesElapsed>0&&!fbUserIsAuthorized&&facebookLoginTry()},jQuery(function(){(function(n){var t,i="facebook-jssdk";n.getElementById(i)||(t=n.createElement("script"),t.id=i,t.async=!0,t.src="//connect.facebook.net/en_US/all.js",n.getElementsByTagName("head")[0].appendChild(t))})(document)});