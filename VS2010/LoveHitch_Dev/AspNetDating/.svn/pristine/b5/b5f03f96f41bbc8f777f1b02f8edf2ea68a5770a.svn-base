var globalDestination;(function(a){a.sundayMorning=function(f,e,d){var e=a.extend({},a.sundayMorning.defaults,e);b(e,function(a){if(f!=null)c(f,a,function(a){d(a)});else d(globalDestination)})};a.fn.sundayMorningReset=function(){return this.each(function(){a(this).unbind(".sundayMorning")})};a.fn.sundayMorning=function(c){var c=a.extend({},a.sundayMorning.defaults,c);return this.each(function(){var f=a(this),g=f.html(),i=g,h=c.source==""?d(f):c.source;if(c.source=="")c.source=d(f);if(c.trigger)f.bind(c.trigger+".sundayMorning",function(a){if(c.ctrlKey!=a.ctrlKey)return false;if(c.shiftKey!=a.shiftKey)return false;c.menuLeft=a.pageX;c.menuTop=a.pageY;if(c.destination!=""){if(c.source==c.destination)return false;if(d(f)==c.destination){f.fadeTo("fast",.1,function(){f.html(i);f.attr("lang",h);f.fadeTo("fast",1)});return false}}b(c,function(a){e(f,g,a)});a.preventDefault();a.stopPropagation()});else b(c,function(a){e(f,g,a)})})};a.fn.sundayMorningDetection=function(b){var c=a.sundayMorning.defaults;return this.each(function(){var e=a(this),d=e.text();f(d,c,function(a){b(a)})})};a.sundayMorningDetection=function(d,b){var c=a.sundayMorning.defaults;f(d,c,function(a){b(a)})};a.fn.sundayMorningBubble=function(d){var d=a.extend({},a.sundayMorning.defaults,d);return this.each(function(){var e=a(this);e.bind("dblclick.sundayMorning",function(e){if(d.ctrlKey!=e.ctrlKey)return false;if(d.shiftKey!=e.shiftKey)return false;if(window.getSelection)var f=window.getSelection();else if(document.getSelection)var f=document.getSelection();else var f=document.selection.createRange().text;f=f.toString();if(f.replace(/\W|\d/g,"")=="")return false;d.menuLeft=menuLeft=e.pageX;d.menuTop=menuTop=e.pageY;b(d,function(b){c(f,b,function(d){var c;c=a('<div class="sundayMorning-bubble"><span><b>'+f+"</b> : "+d.translation+"</span></div>");c.css({position:"absolute",left:menuLeft,top:menuTop}).hide().appendTo("body");a.browser.msie?c.show():c.fadeIn("fast");setTimeout(function(){a.browser.msie?c.remove():c.fadeOut("fast",function(){c.remove()})},b.delay)})});e.preventDefault();e.stopPropagation()})})};a.sundayMorning.translatable={en:"English",ar:"العربية",bg:"български",ca:"català",cs:"česky",da:"Dansk",de:"Deutsch",el:"Ελληνικά",es:"Español",fi:"suomi",fr:"Français",hi:"हिन्दी",hr:"hrvatski",id:"Indonesia",it:"Italiano",iw:"עברית",ja:"日本語",ko:"한국어",lt:"Lietuvių",lv:"latviešu",nl:"Nederlands",no:"norsk",pl:"Polski",pt:"Português",ro:"Română",ru:"Русский",sk:"slovenčina",sl:"slovenščina",sr:"српски",sv:"Svenska",tl:"Filipino",uk:"українська",vi:"Tiếng Việt",CN:"中文 (简体)",TW:"中文 (繁體)"};a.sundayMorning.defaults={apiKey:"notsupplied",delay:3e3,menuTop:50,menuLeft:50,trigger:false,source:"",destination:a.sundayMorning.translatable,ctrlKey:false,shiftKey:false,destinationFallback:a.sundayMorning.translatable};function b(c,f){if(typeof c.destination=="object"){g(c,f);return false}else if(c.destination==""){var d="";if(navigator.browserLanguage)d=navigator.browserLanguage;else if(navigator.language)d=navigator.language;var e=d.split("-");if(a.sundayMorning.translatable[d])c.destination=d;else if(a.sundayMorning.translatable[e[0]])c.destination=e[0];else if(a.sundayMorning.translatable[e[1]])c.destination=e[1];else{c.destination=c.destinationFallback;b(c,f);return false}}f(c)}function f(d,c,b){a.ajax({url:"http://ajax.googleapis.com/ajax/services/language/detect",dataType:"jsonp",data:{q:""+d.substr(0,5e3),v:"1.0",key:c.apiKey},success:function(a){if(a.responseStatus!=200){alert("Translation error: "+a.responseDetails);return false}b({language:a.responseData.language,isReliable:a.responseData.isReliable,confidence:a.responseData.confidence})}})}function c(d,b,c){a.ajax({url:"http://ajax.googleapis.com/ajax/services/language/translate",dataType:"jsonp",data:{q:""+d.substr(0,5e3),v:"1.0",key:b.apiKey,langpair:b.source+"|"+b.destination},success:function(a){if(a.responseStatus!=200){alert("Translation error: "+a.responseDetails);return false}c({translation:a.responseData.translatedText||"",source:a.responseData.detectedSourceLanguage||"",destination:b.destination})}})}function e(a,d,b){a.fadeTo("fast",.1,function(){c(d,b,function(b){a.html(b.translation);a.attr("lang",b.destination);a.fadeTo("fast",1)})})}function d(b){source=a(b).attr("lang");return source?source:""}function g(b,d){html='<div id="sundayMorning-menu"><a class="sundayMorning-close" href="#">X</a><ul>';for(index in b.destination)if(index!=b.source)html+='<li class="sundayMorning-'+index+'"><a href="#" rel="'+index+'">'+b.destination[index]+"</a></li>";html+="</ul></div>";var c=a(html).css({position:"absolute",left:b.menuLeft,top:b.menuTop}).appendTo("body");a("a.sundayMorning-close",c).click(function(){c.remove();return false});a("a",c).click(function(){c.remove();b.destination=a(this).attr("rel");globalDestination=b.destination;d(b);return false});setTimeout(function(){a("html").one("click",function(){c.remove();return false})},50)}})(jQuery);