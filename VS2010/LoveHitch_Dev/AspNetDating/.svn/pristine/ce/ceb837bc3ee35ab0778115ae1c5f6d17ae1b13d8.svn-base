var up_bDoPresence=true,up_iCheckSeconds=10,index=document.location.pathname.lastIndexOf("/"),up_rootpath=document.location.pathname.substring(0,index);function up_launchWM(b,a,h,c,g,f,d,i){up_localUserID=b;var e=null;if(i!=null&&i=="1")e=window.open(up_rootpath+"/IM/im.aspx?myName="+b+"&chatToUsername="+a+"&myRealName="+h+"&userRealName="+c+"&chatToSex="+g+"&chatToAge="+f+"&chatToLocation="+d+"&initiator=1","WMWindow_"+up_replaceAlpha(b)+"_"+up_replaceAlpha(a),"width=360,height=460,toolbar=0,directories=0,menubar=0,status=0,location=0,scrollbars=0,resizable=0");else e=window.open(up_rootpath+"/IM/im.aspx?myName="+b+"&chatToUsername="+a+"&myRealName="+h+"&userRealName="+c+"&chatToSex="+g+"&chatToAge="+f+"&chatToLocation="+d,"WMWindow_"+up_replaceAlpha(b)+"_"+up_replaceAlpha(a),"width=360,height=460,toolbar=0,directories=0,menubar=0,status=0,location=0,scrollbars=0,resizable=0");if(e==null)up_showWMNotify(b,a,h,c,g,f,d);else up_clearWMNotify(a,false)}function up_showWMNotify(k,e,h,c,g,f,d){up_localUserID=k;for(var i=true,a=0;a<up_launchArray.length;a++)if(up_launchArray[a].destID==e){up_launchArray[a].userRealName=h;up_launchArray[a].destRealName=c;up_launchArray[a].destName="<strong>"+c+"</strong>";up_launchArray[a].destSex=g;up_launchArray[a].destAge=f;up_launchArray[a].destLoc=d;i=false}var j="<strong>"+c+"</strong>";if(i){var b={};b.destID=e;b.userRealName=h;b.destRealName=c;b.destName=j;b.destSex=g;b.destAge=f;b.destLoc=d;up_launchArray.push(b)}up_showNotification()}function up_clearWMNotify(b,a){var c=up_launchArray;up_launchArray=[];var d=false;while(c.length>0){var e=c.pop();if(e.destID!=b)up_launchArray.push(e);else d=true}if(d||!a){if(a)frames.up_wmReject.location.href="";frames.up_wmLauncher.location.href=up_rootpath+"/IM/wmWindowOpened.aspx?destinationUserID="+b+"&doPresence="+(up_bDoPresence&&!up_is_win_ie?"true":"false")+"&forceClear="+(a?"true":"false")+"&iRefreshInterval="+up_iCheckSeconds+"&refresh="+Math.floor(Math.random()*1e11)}up_showNotification()}function up_showNotification(){var a=document.getElementById("up_wmNotifications");if(up_launchArray.length>0){if(up_displayedNotificationID!=up_launchArray[0].destID){a.innerHTML='<div class="up_mbox"><div class="up_mbox1"><div class="up_mbox2"></div></div><div class="up_mboxgut" style="text-align:center">'+(up_is_win_ie?"":'<table width="100%" border="0" cellpadding="0" cellspacing="0"><tr><td align="center">')+'<table border="0" cellpadding="2" cellspacing="5"><tr><td nowrap align="center"><strong style="font-size:larger;">Incoming IM Message</strong></td></tr><tr><td align="center">'+up_launchArray[0].destName+' wants to IM you.<br>Would you like to accept?</td></tr><tr><td nowrap align="center"><a style="font-size:larger;" href="" onClick="javascript: up_launchWM( \''+up_localUserID+"', '"+up_launchArray[0].destID+"', '"+up_launchArray[0].userRealName+"', '"+up_launchArray[0].destRealName+"', '"+up_launchArray[0].destSex+"', '"+up_launchArray[0].destAge+"', '"+up_launchArray[0].destLoc+'\' ); return false;">Yes</a> &nbsp; &nbsp; &nbsp; &nbsp; &nbsp; <a style="font-size:larger;" href="" onClick="javascript: up_clearWMNotify( \''+up_launchArray[0].destID+"', true ); return false;\">No</a></td></tr></table>"+(up_is_win_ie?"":"</td></tr></table>")+'</div><div class="up_mbox3"><div class="up_mbox4"></div></div></div>';up_displayedNotificationID=up_launchArray[0].destID;if(!up_is_win_ie)a.style.display="";up_animate(30)}}else{up_displayedNotificationID="";if(!up_is_win_ie)a.style.display="none";else up_animate(-200)}}function up_animate(a){var b=document.getElementById("up_wmNotifications");if(up_iDivCurrentY!=a||up_launchArray.length>0){if(up_iDivCurrentY!=a)up_iDivCurrentY+=a<up_iDivCurrentY?-10:10;b.style.top=up_iDivCurrentY+document.body.scrollTop;clearTimeout(up_animate_timeoutID);up_animate_timeoutID=setTimeout("up_animate("+a+")",33)}else b.style.top=a}function up_replaceAlpha(d){for(var b="",c=0;c<d.length;c++){var a=d.charAt(c);if(a>="A"&&a<="Z"||a>="a"&&a<="z"||a>="0"&&a<="9")b+=a;else b+="_"}return b}function up_checkWM(){if(up_is_win_ie){up_wmCheckImage=new Image;up_wmCheckImage.onLoad=up_onImageLoad();up_wmCheckImage.src=up_rootpath+"/IM/win_ie_pd.aspx?refresh="+Math.floor(Math.random()*1e11);clearTimeout(up_checkWM_timeoutID);up_checkWM_timeoutID=setTimeout("up_checkWM()",1e3*up_iCheckSeconds)}else frames.up_wmLauncher.location.href=up_rootpath+"/IM/wmLauncher.aspx?iRefreshInterval="+up_iCheckSeconds+"&refresh="+Math.floor(Math.random()*1e11)}function up_onImageLoad(){if(!up_wmCheckImage.complete){clearTimeout(up_onImageLoad_timeoutID);up_onImageLoad_timeoutID=setTimeout("up_onImageLoad()",250)}else{if(up_wmCheckImage.height==2)frames.up_wmLauncher.location.href=up_rootpath+"/IM/wmLauncher.aspx?iRefreshInterval=0&refresh="+Math.floor(Math.random()*1e11);clearTimeout(up_checkWM_timeoutID);up_checkWM_timeoutID=setTimeout("up_checkWM()",1e3*up_iCheckSeconds)}}document.write('<style type="text/css">');document.write(".up_mbox { background: #ffffff url(im/images/fbox.gif) repeat-y top right; border: 0; margin: 2px 0 6px 0; padding: 0; }");document.write(".up_mbox1 { background: url(im/images/fbox1.gif) no-repeat top right; height: 8px; font: normal 0px/0px Sans-serif; margin: 0; padding: 0; }");document.write(".up_mbox2 { display: block; background: url(im/images/fbox2.gif) no-repeat top left; height: 8px; width: 8px; font: normal 0px/0px Sans-serif; margin: 0; padding: 0; }");document.write(".up_mbox3 { background: url(im/images/fbox3.gif) no-repeat bottom right; height: 8px; font: normal 0px/0px Sans-serif; margin: 0; padding: 0; }");document.write(".up_mbox4 { display: block; background: url(im/images/fbox4.gif) no-repeat bottom left; height: 8px; width: 8px; font: normal 0px/0px Sans-serif; margin: 0; padding: 0; }");document.write(".up_mboxgut { background: url(im/images/fboxgut.gif) repeat-y top left; font: 11px/18px Verdana, Geneva, Arial, Helvetica, Helve, Sans-serif; margin: 0; padding: 0 10px 0 10px; word-wrap: break-word; }");document.write("</style>");document.write('<iframe name="up_wmLauncher" id="up_wmLauncher" style="position:absolute; top: -200px; z-index:9998; width:100px; height:100px; border: 0px" src=""></iframe>');document.write('<iframe name="up_wmReject" id="up_wmReject" style="position:absolute; top: -200px; z-index:9999; width:100px; height:100px; border: 0px" src=""></iframe>');document.write('<div id="up_wmNotifications" style="position:absolute; width:250px; z-index:9997; left: 30px; top: -200px;"></div>');var up_iDivCurrentY=-200,up_launchArray=[],up_localUserID="",up_displayedNotificationID="",up_wmCheckImage=null,up_checkWM_timeoutID=null,up_onImageLoad_timeoutID=null,up_animate_timeoutID=null,up_agt=navigator.userAgent.toLowerCase(),up_appVer=navigator.appVersion.toLowerCase(),up_is_mac=up_agt.indexOf("mac")!=-1,up_is_safari=up_agt.indexOf("safari")!=-1&&up_is_mac,up_is_khtml=up_is_safari||up_agt.indexOf("konqueror")!=-1,up_is_ie=up_appVer.indexOf("msie")!=-1&&up_agt.indexOf("opera")==-1&&!up_is_khtml,up_is_win=up_is_mac?false:up_agt.indexOf("win")!=-1||up_agt.indexOf("16bit")!=-1,up_is_win_ie=up_is_win&&up_is_ie;up_bDoPresence&&up_checkWM();