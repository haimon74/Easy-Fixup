CKEDITOR.plugins.add("colorbutton",{requires:["panelbutton","floatpanel","styles"],init:function(n){function r(t,i,r){n.ui.add(t,CKEDITOR.UI_PANELBUTTON,{label:r,title:r,className:"cke_button_"+t.toLowerCase(),modes:{wysiwyg:1},panel:{css:n.skin.editor.css},onBlock:function(n,t){var f=n.addBlock(t),r;f.autoSize=!0,f.element.addClass("cke_colorblock"),f.element.setHtml(u(n,i)),r=f.keys,r[39]="next",r[9]="next",r[37]="prev",r[CKEDITOR.SHIFT+9]="prev",r[32]="click"}})}function u(r,u){var f=[],c=i.colorButton_colors.split(","),s=CKEDITOR.tools.addFunction(function(t,u){var e,f;if(t=="?"){e=arguments.callee;function t(n){this.removeListener("ok",t),this.removeListener("cancel",t),n.name=="ok"&&e(this.getContentElement("picker","selectedColor").getValue(),u)}n.openDialog("colordialog",function(){this.on("ok",t);this.on("cancel",t)});return}n.focus(),r.hide(),f=new CKEDITOR.style(i["colorButton_"+u+"Style"],t&&{color:t}),n.fire("saveSnapshot"),t?f.apply(n.document):f.remove(n.document),n.fire("saveSnapshot")}),e,o,h;for(f.push('<a class="cke_colorauto" _cke_focus=1 hidefocus=true title="',t.auto,'" onclick="CKEDITOR.tools.callFunction(',s,",null,'",u,"');return false;\" href=\"javascript:void('",t.auto,'\')"><table cellspacing=0 cellpadding=0 width="100%"><tr><td><span class="cke_colorbox" style="background-color:#000"><\/span><\/td><td colspan=7 align=center>',t.auto,'<\/td><\/tr><\/table><\/a><table cellspacing=0 cellpadding=0 width="100%">'),e=0;e<c.length;e++)e%8==0&&f.push("<\/tr><tr>"),o=c[e],h=n.lang.colors[o]||o,f.push('<td><a class="cke_colorbox" _cke_focus=1 hidefocus=true title="',h,'" onclick="CKEDITOR.tools.callFunction(',s,",'#",o,"','",u,"'); return false;\" href=\"javascript:void('",h,'\')"><span class="cke_colorbox" style="background-color:#',o,'"><\/span><\/a><\/td>');return i.colorButton_enableMore&&f.push('<\/tr><tr><td colspan=8 align=center><a class="cke_colormore" _cke_focus=1 hidefocus=true title="',t.more,'" onclick="CKEDITOR.tools.callFunction(',s,",'?','",u,"');return false;\" href=\"javascript:void('",t.more,"')\">",t.more,"<\/a><\/td>"),f.push("<\/tr><\/table>"),f.join("")}var i=n.config,t=n.lang.colorButton;CKEDITOR.env.hc||(r("TextColor","fore",t.textColorTitle),r("BGColor","back",t.bgColorTitle))}}),CKEDITOR.config.colorButton_enableMore=!0,CKEDITOR.config.colorButton_colors="000,800000,8B4513,2F4F4F,008080,000080,4B0082,696969,B22222,A52A2A,DAA520,006400,40E0D0,0000CD,800080,808080,F00,FF8C00,FFD700,008000,0FF,00F,EE82EE,A9A9A9,FFA07A,FFA500,FFFF00,00FF00,AFEEEE,ADD8E6,DDA0DD,D3D3D3,FFF0F5,FAEBD7,FFFFE0,F0FFF0,F0FFFF,F0F8FF,E6E6FA,FFF",CKEDITOR.config.colorButton_foreStyle={element:"span",styles:{color:"#(color)"},overrides:[{element:"font",attributes:{color:null}}]},CKEDITOR.config.colorButton_backStyle={element:"span",styles:{"background-color":"#(color)"}};