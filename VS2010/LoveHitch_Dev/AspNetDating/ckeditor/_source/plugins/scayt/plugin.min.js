(function(){function i(n,t){var r=!1,i;for(i in t)if(t[i]===n||t[i]==n){r=!0;break}return r}var t="scaytcheck",r="",e=null,f=function(){var t=this,f=function(){var i={},o,r,u,f,h;if(i.srcNodeRef=t.document.getWindow().$.frameElement,i.assocApp="CKEDITOR."+CKEDITOR.version+"@"+CKEDITOR.revision,i.customerid=t.config.scayt_customerid||"1:WvF0D4-UtPqN1-43nkD4-NKvUm2-daQqk3-LmNiI-z7Ysb4-mwry24-T8YrS3-Q2tpq2",i.customDictionaryIds=t.config.scayt_customDictionaryIds,i.userDictionaryName=t.config.scayt_userDictionaryName,i.sLang=t.config.scayt_sLang||"en_US",CKEDITOR._scaytParams)for(o in CKEDITOR._scaytParams)i[o]=CKEDITOR._scaytParams[o];r=new window.scayt(i),u=n.instances[t.name],u&&(r.sLang=u.sLang,r.option(u.option()),r.paused=u.paused),n.instances[t.name]=r;var c=window.scayt.uiTags,s=[];for(f=0,h=4;f<h;f++)s.push(c[f]&&n.uiTabs[f]);n.uiTabs=s;try{r.setDisabled(e===!1)}catch(l){}t.fire("showScaytState")},i,u;t.on("contentDom",f);t.on("contentDomUnload",function(){for(var i=CKEDITOR.document.getElementsByTag("script"),n=0;n<i.count();n++){var t=i.getItem(n),r=t.getId(),u=t.getAttribute("src");r&&u&&r.match(/^dojoIoScript(\d+)$/i)&&u.match(/^https?:\/\/svc\.spellchecker\.net\/spellcheck\/script\/ssrv\.cgi/i)&&t.remove()}});t.on("beforeCommandExec",function(i){if((i.data.name=="source"||i.data.name=="newpage")&&t.mode=="wysiwyg"){var r=n.getScayt(t);r&&(e=r.paused=!r.disabled,r.destroy(),delete n.instances[t.name])}});t.on("destroy",function(){n.getScayt(t).destroy()});t.on("afterSetData",function(){n.isScaytEnabled(t)&&n.getScayt(t).refresh()});t.on("insertElement",function(){var i=n.getScayt(t);if(n.isScaytEnabled(t)){CKEDITOR.env.ie&&t.getSelection().unlock(!0);try{i.refresh()}catch(r){}}},this,null,50);t.on("insertHtml",function(){var i=n.getScayt(t);if(n.isScaytEnabled(t)){CKEDITOR.env.ie&&t.getSelection().unlock(!0);try{i.refresh()}catch(r){}}},this,null,50);t.on("scaytDialog",function(i){i.data.djConfig=window.djConfig,i.data.scayt_control=n.getScayt(t),i.data.tab=r,i.data.scayt=window.scayt});i=t.dataProcessor,u=i&&i.htmlFilter,u&&u.addRules({elements:{span:function(n){if(n.attributes.scayt_word&&n.attributes.scaytid)return delete n.name,n}}}),t.document&&f()};CKEDITOR.plugins.scayt={engineLoaded:!1,instances:{},getScayt:function(n){return this.instances[n.name]},isScaytReady:function(n){return this.engineLoaded===!0&&"undefined"!=typeof window.scayt&&this.getScayt(n)},isScaytEnabled:function(n){var t=this.getScayt(n);return t?t.disabled===!1:!1},loadEngine:function(t){var i;if(this.engineLoaded===!0)return f.apply(t);if(this.engineLoaded==-1)return CKEDITOR.on("scaytReady",function(){f.apply(t)});CKEDITOR.on("scaytReady",f,t);CKEDITOR.on("scaytReady",function(){this.engineLoaded=!0},this,null,0);this.engineLoaded=-1,i=document.location.protocol,i=i.search(/https?:/)!=-1?i:"http:";var r=t.config.scayt_srcUrl||i+"//svc.spellchecker.net/spellcheck3/lf/scayt/scayt21.js",u=n.parseUrl(r).path+"/";return CKEDITOR._djScaytConfig={baseUrl:u,addOnLoad:[function(){CKEDITOR.fireOnce("scaytReady")}],isDebug:!1},CKEDITOR.document.getHead().append(CKEDITOR.document.createElement("script",{attributes:{type:"text/javascript",src:r}})),null},parseUrl:function(n){var t;return n.match&&(t=n.match(/(.*)[\/\\](.*?\.\w+)$/))?{path:t[1],file:t[2]}:n}};var n=CKEDITOR.plugins.scayt,u=function(n,t,i,r,u,f,e){n.addCommand(r,u),n.addMenuItem(r,{label:i,command:r,group:f,order:e})},o={preserveState:!0,editorFocus:!1,exec:function(t){var i,r;if(n.isScaytReady(t))i=n.isScaytEnabled(t),this.setState(i?CKEDITOR.TRISTATE_OFF:CKEDITOR.TRISTATE_ON),r=n.getScayt(t),r.setDisabled(i);else if(!t.config.scayt_autoStartup&&n.engineLoaded>=0){this.setState(CKEDITOR.TRISTATE_DISABLED);t.on("showScaytState",function(){this.removeListener(),this.setState(n.isScaytEnabled(t)?CKEDITOR.TRISTATE_ON:CKEDITOR.TRISTATE_OFF)},this);n.loadEngine(t)}}};CKEDITOR.plugins.add("scayt",{requires:["menubutton"],beforeInit:function(n){n.config.menu_groups="scayt_suggest,scayt_moresuggest,scayt_control,"+n.config.menu_groups},init:function(f){var l={},e={},y=f.addCommand(t,o),a,s,v,w,b,h,c,p;for(CKEDITOR.dialog.add(t,CKEDITOR.getUrl(this.path+"dialogs/options.js")),a=f.config.scayt_uiTabs||"1,1,1",s=[],a=a.split(","),v=0,w=3;v<w;v++)b=parseInt(a[v]||"1",10),s.push(b);if(h="scaytButton",f.addMenuGroup(h),c={},c.scaytToggle={label:f.lang.scayt.enable,command:t,group:h},s[0]==1&&(c.scaytOptions={label:f.lang.scayt.options,group:h,onClick:function(){r="options",f.openDialog(t)}}),s[1]==1&&(c.scaytLangs={label:f.lang.scayt.langs,group:h,onClick:function(){r="langs",f.openDialog(t)}}),s[2]==1&&(c.scaytDict={label:f.lang.scayt.dictionariesTab,group:h,onClick:function(){r="dictionaries",f.openDialog(t)}}),c.scaytAbout={label:f.lang.scayt.about,group:h,onClick:function(){r="about",f.openDialog(t)}},s[3]=1,n.uiTabs=s,f.addMenuItems(c),f.ui.add("Scayt",CKEDITOR.UI_MENUBUTTON,{label:f.lang.scayt.title,title:f.lang.scayt.title,className:"cke_button_scayt",onRender:function(){y.on("state",function(){this.setState(y.state)},this)},onMenu:function(){var t=n.isScaytEnabled(f);return f.getMenuItem("scaytToggle").label=f.lang.scayt[t?"disable":"enable"],{scaytToggle:CKEDITOR.TRISTATE_OFF,scaytOptions:t&&n.uiTabs[0]?CKEDITOR.TRISTATE_OFF:CKEDITOR.TRISTATE_DISABLED,scaytLangs:t&&n.uiTabs[1]?CKEDITOR.TRISTATE_OFF:CKEDITOR.TRISTATE_DISABLED,scaytDict:t&&n.uiTabs[2]?CKEDITOR.TRISTATE_OFF:CKEDITOR.TRISTATE_DISABLED,scaytAbout:t&&n.uiTabs[3]?CKEDITOR.TRISTATE_OFF:CKEDITOR.TRISTATE_DISABLED}}}),f.contextMenu&&f.addMenuItems&&f.contextMenu.addListener(function(t){var s,v,o,r,w,c,y,b,k,d;if(!(n.isScaytEnabled(f)&&t)||(s=n.getScayt(f),v=s.getWord(t.$),!v))return null;var g=s.getLang(),h=window.scayt.getSuggestion(v,g);if(!h||!h.length)return null;for(r in l)delete f._.menuItems[r],delete f._.commands[r];for(r in e)delete f._.menuItems[r],delete f._.commands[r];l={},e={};var nt=f.config.scayt_moreSuggestions||"on",p=!1,a=f.config.scayt_maxSuggestions;for(typeof a!="number"&&(a=5),a||(a=h.length),o=f.config.scayt_contextCommands||"all",o=o.split("|"),r=0,w=h.length;r<w;r+=1)c="scayt_suggestion_"+h[r].replace(" ","_"),y=function(n,t){return{exec:function(){s.replace(n,t)}}}(t.$,h[r]),r<a?(u(f,"button_"+c,h[r],c,y,"scayt_suggest",r+1),{}[c]=CKEDITOR.TRISTATE_OFF,e[c]=CKEDITOR.TRISTATE_OFF):nt=="on"&&(u(f,"button_"+c,h[r],c,y,"scayt_moresuggest",r+1),l[c]=CKEDITOR.TRISTATE_OFF,p=!0);return p&&(f.addMenuItem("scayt_moresuggest",{label:f.lang.scayt.moreSuggestions,group:"scayt_moresuggest",order:10,getItems:function(){return l}}),e.scayt_moresuggest=CKEDITOR.TRISTATE_OFF),(i("all",o)||i("ignore",o))&&(b={exec:function(){s.ignore(t.$)}},u(f,"ignore",f.lang.scayt.ignore,"scayt_ignore",b,"scayt_control",1),e.scayt_ignore=CKEDITOR.TRISTATE_OFF),(i("all",o)||i("ignoreall",o))&&(k={exec:function(){s.ignoreAll(t.$)}},u(f,"ignore_all",f.lang.scayt.ignoreAll,"scayt_ignore_all",k,"scayt_control",2),e.scayt_ignore_all=CKEDITOR.TRISTATE_OFF),(i("all",o)||i("add",o))&&(d={exec:function(){window.scayt.addWordToUserDictionary(t.$)}},u(f,"add_word",f.lang.scayt.addWord,"scayt_add_word",d,"scayt_control",3),e.scayt_add_word=CKEDITOR.TRISTATE_OFF),s.fireOnContextMenu&&s.fireOnContextMenu(f),e}),f.config.scayt_autoStartup){p=function(){f.removeListener("showScaytState",p),y.setState(n.isScaytEnabled(f)?CKEDITOR.TRISTATE_ON:CKEDITOR.TRISTATE_OFF)};f.on("showScaytState",p);n.loadEngine(f)}}})})();