CKEDITOR.dialog.add("smiley",function(n){for(var r=n.config,f=r.smiley_images,u=8,e,o=function(t){var i=t.data.getTarget(),r=i.getName();if(r=="td")i=i.getChild([0,0]);else if(r=="a")i=i.getChild(0);else if(r!="img")return;var u=i.getAttribute("cke_src"),f=i.getAttribute("title"),o=n.document.createElement("img",{attributes:{src:u,_cke_saved_src:u,title:f,alt:f}});n.insertElement(o),e.hide()},h=CKEDITOR.tools.addFunction(function(n,t){n=new CKEDITOR.dom.event(n),t=new CKEDITOR.dom.element(t);var r,i,u=n.getKeystroke();switch(u){case 39:(r=t.getParent().getNext())&&(i=r.getChild(0),i.focus()),n.preventDefault();break;case 37:(r=t.getParent().getPrevious())&&(i=r.getChild(0),i.focus()),n.preventDefault();break;case 38:(r=t.getParent().getParent().getPrevious())&&(i=r.getChild([t.getParent().getIndex(),0]),i.focus()),n.preventDefault();break;case 40:(r=t.getParent().getParent().getNext())&&(i=r.getChild([t.getParent().getIndex(),0]),i&&i.focus()),n.preventDefault();break;case 32:o({data:n}),n.preventDefault();break;case 9:(r=t.getParent().getNext())?(i=r.getChild(0),i.focus(),n.preventDefault(!0)):(r=t.getParent().getParent().getNext())&&(i=r.getChild([0,0]),i&&i.focus(),n.preventDefault(!0));break;case CKEDITOR.SHIFT+9:(r=t.getParent().getPrevious())?(i=r.getChild(0),i.focus(),n.preventDefault(!0)):(r=t.getParent().getParent().getPrevious())&&(i=r.getLast().getChild(0),i.focus(),n.preventDefault(!0));break;default:return}}),i=['<table cellspacing="2" cellpadding="2"',CKEDITOR.env.ie&&CKEDITOR.env.quirks?' style="position:absolute;"':"","><tbody>"],s,t=0;t<f.length;t++)t%u==0&&i.push("<tr>"),i.push('<td class="cke_dark_background cke_hand cke_centered" style="vertical-align: middle;"><a href="javascript:void(0)" class="cke_smile" tabindex="-1" onkeydown="CKEDITOR.tools.callFunction( ',h,', event, this );">','<img class="hand" title="',r.smiley_descriptions[t],'" cke_src="',CKEDITOR.tools.htmlEncode(r.smiley_path+f[t]),'" alt="',r.smiley_descriptions[t],'"',' src="',CKEDITOR.tools.htmlEncode(r.smiley_path+f[t]),'"',CKEDITOR.env.ie?" onload=\"this.setAttribute('width', 2); this.removeAttribute('width');\" ":"","><\/a>","<\/td>"),t%u==u-1&&i.push("<\/tr>");if(t<u-1){for(;t<u-1;t++)i.push("<td><\/td>");i.push("<\/tr>")}return i.push("<\/tbody><\/table>"),s={type:"html",html:i.join(""),onLoad:function(n){e=n.sender},focus:function(){var n=this.getElement().getChild([0,0,0,0]);n.focus()},onClick:o,style:"width: 100%; height: 100%; border-collapse: separate;"},{title:n.lang.smiley.title,minWidth:270,minHeight:120,contents:[{id:"tab1",label:"",title:"",expand:!0,padding:0,elements:[s]}],buttons:[CKEDITOR.dialog.cancelButton]}});