(function(){function i(n,t){for(var r,i=0;n&&i<t.length;i++)r=t[i],n=n.replace(r[0],r[1]);return n}function t(n,t,i){var r,u,o,e,f;if(typeof t=="function"&&(t=[t]),o=n.length,e=t&&t.length,e){for(r=0;r<o&&n[r].pri<i;r++);for(u=e-1;u>=0;u--)f=t[u],f&&(f.pri=i,n.splice(r,0,f))}}function r(t,i,r){var u,f;if(i)for(u in i)f=t[u],t[u]=n(f,i[u],r),f||t.$length++}function n(n,i,r){if(i)return i.pri=r,n?(n.splice?t(n,i,r):(n=n.pri>r?[i,n]:[n,i],n.filter=u),n):(i.filter=i,i)}function u(n){for(var u=typeof n=="object",r,t,i=0;i<this.length;i++)if(r=this[i],t=r.apply(window,arguments),typeof t!="undefined"){if(t===!1)return!1;if(u&&t!=n)return t}return null}CKEDITOR.htmlParser.filter=CKEDITOR.tools.createClass({$:function(n){this._={elementNames:[],attributeNames:[],elements:{$length:0},attributes:{$length:0}},n&&this.addRules(n,10)},proto:{addRules:function(i,u){typeof u!="number"&&(u=10),t(this._.elementNames,i.elementNames,u),t(this._.attributeNames,i.attributeNames,u),r(this._.elements,i.elements,u),r(this._.attributes,i.attributes,u),this._.text=n(this._.text,i.text,u)||this._.text,this._.comment=n(this._.comment,i.comment,u)||this._.comment,this._.root=n(this._.root,i.root,u)||this._.root},onElementName:function(n){return i(n,this._.elementNames)},onAttributeName:function(n){return i(n,this._.attributeNames)},onText:function(n){var t=this._.text;return t?t.filter(n):n},onComment:function(n,t){var i=this._.comment;return i?i.filter(n,t):n},onFragment:function(n){var t=this._.root;return t?t.filter(n):n},onElement:function(n){for(var u=[this._.elements["^"],this._.elements[n.name],this._.elements.$],r,t,i=0;i<3;i++)if(r=u[i],r){if(t=r.filter(n,this),t===!1)return null;if(t&&t!=n)return this.onNode(t);if(n.parent&&!n.name)break}return n},onNode:function(n){var t=n.type;return t==CKEDITOR.NODE_ELEMENT?this.onElement(n):t==CKEDITOR.NODE_TEXT?new CKEDITOR.htmlParser.text(this.onText(n.value)):t==CKEDITOR.NODE_COMMENT?new CKEDITOR.htmlParser.comment(this.onComment(n.value)):null},onAttribute:function(n,t,i){var u=this._.attributes[t],r;if(u){if(r=u.filter(i,n,this),r===!1)return!1;if(typeof r!="undefined")return r}return i}}})})();