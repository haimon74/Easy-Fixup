CKEDITOR.plugins.add("dialogui"),function(){var n=function(n){var t,i;for(this._||(this._={}),this._["default"]=this._.initValue=n["default"]||"",t=[this._],i=1;i<arguments.length;i++)t.push(arguments[i]);return t.push(!0),CKEDITOR.tools.extend.apply(CKEDITOR.tools,t),this._},f={build:function(n,t,i){return new CKEDITOR.ui.dialog.textInput(n,t,i)}},t={build:function(n,t,i){return new CKEDITOR.ui.dialog[t.type](n,t,i)}},i={isChanged:function(){return this.getValue()!=this.getInitValue()},reset:function(){this.setValue(this.getInitValue())},setInitValue:function(){this._.initValue=this.getValue()},resetInitValue:function(){this._.initValue=this._["default"]},getInitValue:function(){return this._.initValue}},r=CKEDITOR.tools.extend({},CKEDITOR.ui.dialog.uiElement.prototype.eventProcessors,{onChange:function(n,t){if(!this._.domOnChangeRegistered){n.on("load",function(){this.getInputElement().on("change",function(){this.fire("change",{value:this.getValue()})},this)},this);this._.domOnChangeRegistered=!0}this.on("change",t)}},!0),e=/^on([A-Z]\w+)/,u=function(n){for(var t in n)(e.test(t)||t=="title"||t=="type")&&delete n[t];return n};CKEDITOR.tools.extend(CKEDITOR.ui.dialog,{labeledElement:function(t,i,r,u){var f,o,e;arguments.length<4||(f=n.call(this,i),f.labelId=CKEDITOR.tools.getNextNumber()+"_label",o=this._.children=[],e=function(){var n=[],r;return i.labelLayout!="horizontal"?n.push('<div class="cke_dialog_ui_labeled_label" id="',f.labelId,'" >',i.label,"<\/div>",'<div class="cke_dialog_ui_labeled_content">',u(t,i),"<\/div>"):(r={type:"hbox",widths:i.widths,padding:0,children:[{type:"html",html:'<span class="cke_dialog_ui_labeled_label" id="'+f.labelId+'">'+CKEDITOR.tools.htmlEncode(i.label)+"<\/span>"},{type:"html",html:'<span class="cke_dialog_ui_labeled_content">'+u(t,i)+"<\/span>"}]},CKEDITOR.dialog._.uiElementBuilders.hbox.build(t,r,n)),n.join("")},CKEDITOR.ui.dialog.uiElement.call(this,t,i,r,"div",null,null,e))},textInput:function(t,i,r){var o,u,e,f,s;if(!(arguments.length<3)){n.call(this,i),o=this._.inputId=CKEDITOR.tools.getNextNumber()+"_textInput",u={"class":"cke_dialog_ui_input_"+i.type,id:o,type:"text"},i.validate&&(this.validate=i.validate),i.maxLength&&(u.maxlength=i.maxLength),i.size&&(u.size=i.size),e=this,f=!1;t.on("load",function(){e.getInputElement().on("keydown",function(n){n.data.getKeystroke()==13&&(f=!0)});e.getInputElement().on("keyup",function(n){n.data.getKeystroke()==13&&f&&(t.getButton("ok")&&setTimeout(function(){t.getButton("ok").click()},0),f=!1)},null,null,1e3)});s=function(){var n=['<div class="cke_dialog_ui_input_',i.type,'"'],t;i.width&&n.push('style="width:'+i.width+'" '),n.push("><input ");for(t in u)n.push(t+'="'+u[t]+'" ');return n.push(" /><\/div>"),n.join("")},CKEDITOR.ui.dialog.labeledElement.call(this,t,i,r,s)}},textarea:function(t,i,r){var f;if(!(arguments.length<3)){n.call(this,i);var e=this,o=this._.inputId=CKEDITOR.tools.getNextNumber()+"_textarea",u={};i.validate&&(this.validate=i.validate),u.rows=i.rows||5,u.cols=i.cols||20,f=function(){var n=['<div class="cke_dialog_ui_input_textarea"><textarea class="cke_dialog_ui_input_textarea" id="',o,'" '],t;for(t in u)n.push(t+'="'+CKEDITOR.tools.htmlEncode(u[t])+'" ');return n.push(">",CKEDITOR.tools.htmlEncode(e._["default"]),"<\/textarea><\/div>"),n.join("")},CKEDITOR.ui.dialog.labeledElement.call(this,t,i,r,f)}},checkbox:function(t,i,r){var f,e;arguments.length<3||(f=n.call(this,i,{"default":!!i["default"]}),i.validate&&(this.validate=i.validate),e=function(){var e=CKEDITOR.tools.extend({},i,{id:i.id?i.id+"_checkbox":CKEDITOR.tools.getNextNumber()+"_checkbox"},!0),n=[],r={"class":"cke_dialog_ui_checkbox_input",type:"checkbox"};return u(e),i["default"]&&(r.checked="checked"),f.checkbox=new CKEDITOR.ui.dialog.uiElement(t,e,n,"input",null,r),n.push(' <label for="',r.id,'">',CKEDITOR.tools.htmlEncode(i.label),"<\/label>"),n.join("")},CKEDITOR.ui.dialog.uiElement.call(this,t,i,r,"span",null,null,e))},radio:function(t,i,r){if(!(arguments.length<3)){n.call(this,i),this._["default"]||(this._["default"]=this._.initValue=i.items[0][1]),i.validate&&(this.validate=i.valdiate);var f=[],e=this,o=function(){for(var c=[],l=[],y=i.id?i.id+"_radio":CKEDITOR.tools.getNextNumber()+"_radio",r=0;r<i.items.length;r++){var n=i.items[r],p=n[2]!==undefined?n[2]:n[0],a=n[1]!==undefined?n[1]:n[0],s=CKEDITOR.tools.extend({},i,{id:CKEDITOR.tools.getNextNumber()+"_radio_input",title:null,type:null},!0),v=CKEDITOR.tools.extend({},s,{id:null,title:p},!0),h={type:"radio","class":"cke_dialog_ui_radio_input",name:y,value:a},o=[];e._["default"]==a&&(h.checked="checked"),u(s),u(v),f.push(new CKEDITOR.ui.dialog.uiElement(t,s,o,"input",null,h)),o.push(" "),new CKEDITOR.ui.dialog.uiElement(t,v,o,"label",null,{"for":h.id},n[0]),c.push(o.join(""))}return new CKEDITOR.ui.dialog.hbox(t,[],c,l),l.join("")};CKEDITOR.ui.dialog.labeledElement.call(this,t,i,r,o),this._.children=f}},button:function(t,i,r){var u,f;if(arguments.length){typeof i=="function"&&(i=i(t.getParentEditor())),n.call(this,i,{disabled:i.disabled||!1}),CKEDITOR.event.implementOn(this),u=this;t.on("load",function(){var n=this.getElement();(function(){n.on("click",function(n){u.fire("click",{dialog:u.getDialog()}),n.data.preventDefault()})})(),n.unselectable()},this);f=CKEDITOR.tools.extend({},i),delete f.style,CKEDITOR.ui.dialog.uiElement.call(this,t,f,r,"a",null,{style:i.style,href:"javascript:void(0)",title:i.label,hidefocus:"true","class":i["class"]},'<span class="cke_dialog_ui_button">'+CKEDITOR.tools.htmlEncode(i.label)+"<\/span>")}},select:function(t,i,r){var f,e;arguments.length<3||(f=n.call(this,i),i.validate&&(this.validate=i.validate),e=function(){var o=CKEDITOR.tools.extend({},i,{id:i.id?i.id+"_select":CKEDITOR.tools.getNextNumber()+"_select"},!0),s=[],h=[],e={"class":"cke_dialog_ui_input_select"},r,n;for(i.size!=undefined&&(e.size=i.size),i.multiple!=undefined&&(e.multiple=i.multiple),u(o),r=0;r<i.items.length&&(n=i.items[r]);r++)h.push('<option value="',CKEDITOR.tools.htmlEncode(n[1]!==undefined?n[1]:n[0]),'" /> ',CKEDITOR.tools.htmlEncode(n[0]));return f.select=new CKEDITOR.ui.dialog.uiElement(t,o,s,"select",null,e,h.join("")),s.join("")},CKEDITOR.ui.dialog.labeledElement.call(this,t,i,r,e))},file:function(t,i,r){var u,f;if(!(arguments.length<3)){i["default"]===undefined&&(i["default"]=""),u=CKEDITOR.tools.extend(n.call(this,i),{definition:i,buttons:[]}),i.validate&&(this.validate=i.validate),f=function(){u.frameId=CKEDITOR.tools.getNextNumber()+"_fileInput";var t=CKEDITOR.env.isCustomDomain(),n=['<iframe frameborder="0" allowtransparency="0" class="cke_dialog_ui_input_file" id="',u.frameId,'" title="',i.label,'" src="javascript:void('];return n.push(t?"(function(){document.open();document.domain='"+document.domain+"';document.close();})()":"0"),n.push(')"><\/iframe>'),n.join("")};t.on("load",function(){var n=CKEDITOR.document.getById(u.frameId),t=n.getParent();t.addClass("cke_dialog_ui_input_file")});CKEDITOR.ui.dialog.labeledElement.call(this,t,i,r,f)}},fileButton:function(t,i,r){var o,e,u,f;if(!(arguments.length<3)){o=n.call(this,i),e=this,i.validate&&(this.validate=i.validate),u=CKEDITOR.tools.extend({},i),f=u.onClick,u.className=(u.className?u.className+" ":"")+"cke_dialog_ui_button",u.onClick=function(n){var r=i["for"];f&&f.call(this,n)===!1||(t.getContentElement(r[0],r[1]).submit(),this.disable())};t.on("load",function(){t.getContentElement(i["for"][0],i["for"][1])._.buttons.push(e)});CKEDITOR.ui.dialog.button.call(this,t,u,r)}},html:function(){var n=/^\s*<[\w:]+\s+([^>]*)?>/,t=/^(\s*<[\w:]+(?:\s+[^>]*)?)((?:.|\r|\n)+)$/,i=/\/$/;return function(r,u,f){var s,h,o,c,e,l,a;arguments.length<3||(s=[],o=u.html,o.charAt(0)!="<"&&(o="<span>"+o+"<\/span>"),u.focus&&(l=this.focus,this.focus=function(){l.call(this),u.focus.call(this),this.fire("focus")},u.isFocusable&&(a=this.isFocusable,this.isFocusable=a),this.keyboardFocusable=!0),CKEDITOR.ui.dialog.uiElement.call(this,r,u,s,"span",null,null,""),h=s.join(""),c=h.match(n),e=o.match(t)||["","",""],i.test(e[1])&&(e[1]=e[1].slice(0,-1),e[2]="/"+e[2]),f.push([e[1]," ",c[1]||"",e[2]].join("")))}}()},!0),CKEDITOR.ui.dialog.html.prototype=new CKEDITOR.ui.dialog.uiElement,CKEDITOR.ui.dialog.labeledElement.prototype=CKEDITOR.tools.extend(new CKEDITOR.ui.dialog.uiElement,{setLabel:function(n){var t=CKEDITOR.document.getById(this._.labelId);return t.getChildCount()<1?new CKEDITOR.dom.text(n,CKEDITOR.document).appendTo(t):t.getChild(0).$.nodeValue=n,this},getLabel:function(){var n=CKEDITOR.document.getById(this._.labelId);return!n||n.getChildCount()<1?"":n.getChild(0).getText()},eventProcessors:r},!0),CKEDITOR.ui.dialog.button.prototype=CKEDITOR.tools.extend(new CKEDITOR.ui.dialog.uiElement,{click:function(){return this._.disabled?(this.getElement().$.blur(),!1):this.fire("click",{dialog:this._.dialog})},enable:function(){this._.disabled=!1;var n=this.getElement();n&&n.removeClass("disabled")},disable:function(){this._.disabled=!0,this.getElement().addClass("disabled")},isVisible:function(){return this.getElement().getFirst().isVisible()},isEnabled:function(){return!this._.disabled},eventProcessors:CKEDITOR.tools.extend({},CKEDITOR.ui.dialog.uiElement.prototype.eventProcessors,{onClick:function(n,t){this.on("click",t)}},!0),accessKeyUp:function(){this.click()},accessKeyDown:function(){this.focus()},keyboardFocusable:!0},!0),CKEDITOR.ui.dialog.textInput.prototype=CKEDITOR.tools.extend(new CKEDITOR.ui.dialog.labeledElement,{getInputElement:function(){return CKEDITOR.document.getById(this._.inputId)},focus:function(){var n=this.selectParentTab();setTimeout(function(){var t=n.getInputElement();t&&t.$.focus()},0)},select:function(){var n=this.selectParentTab();setTimeout(function(){var t=n.getInputElement();t&&(t.$.focus(),t.$.select())},0)},accessKeyUp:function(){this.select()},setValue:function(n){return n=n||"",CKEDITOR.ui.dialog.uiElement.prototype.setValue.call(this,n)},keyboardFocusable:!0},i,!0),CKEDITOR.ui.dialog.textarea.prototype=new CKEDITOR.ui.dialog.textInput,CKEDITOR.ui.dialog.select.prototype=CKEDITOR.tools.extend(new CKEDITOR.ui.dialog.labeledElement,{getInputElement:function(){return this._.select.getElement()},add:function(n,t,i){var r=new CKEDITOR.dom.element("option",this.getDialog().getParentEditor().document),u=this.getInputElement().$;return r.$.text=n,r.$.value=t===undefined||t===null?n:t,i===undefined||i===null?CKEDITOR.env.ie?u.add(r.$):u.add(r.$,null):u.add(r.$,i),this},remove:function(n){var t=this.getInputElement().$;return t.remove(n),this},clear:function(){for(var n=this.getInputElement().$;n.length>0;)n.remove(0);return this},keyboardFocusable:!0},i,!0),CKEDITOR.ui.dialog.checkbox.prototype=CKEDITOR.tools.extend(new CKEDITOR.ui.dialog.uiElement,{getInputElement:function(){return this._.checkbox.getElement()},setValue:function(n){this.getInputElement().$.checked=n,this.fire("change",{value:n})},getValue:function(){return this.getInputElement().$.checked},accessKeyUp:function(){this.setValue(!this.getValue())},eventProcessors:{onChange:function(n,t){if(CKEDITOR.env.ie){n.on("load",function(){var n=this._.checkbox.getElement();n.on("propertychange",function(t){t=t.data.$,t.propertyName=="checked"&&this.fire("change",{value:n.$.checked})},this)},this);this.on("change",t)}else return r.onChange.apply(this,arguments);return null}},keyboardFocusable:!0},i,!0),CKEDITOR.ui.dialog.radio.prototype=CKEDITOR.tools.extend(new CKEDITOR.ui.dialog.uiElement,{setValue:function(n){for(var r=this._.children,i,t=0;t<r.length&&(i=r[t]);t++)i.getElement().$.checked=i.getValue()==n;this.fire("change",{value:n})},getValue:function(){for(var t=this._.children,n=0;n<t.length;n++)if(t[n].getElement().$.checked)return t[n].getValue();return null},accessKeyUp:function(){for(var t=this._.children,n=0;n<t.length;n++)if(t[n].getElement().$.checked){t[n].getElement().focus();return}t[0].getElement().focus()},eventProcessors:{onChange:function(n,t){if(CKEDITOR.env.ie){n.on("load",function(){for(var t=this._.children,r=this,i,n=0;n<t.length;n++){i=t[n].getElement();i.on("propertychange",function(n){n=n.data.$,n.propertyName=="checked"&&this.$.checked&&r.fire("change",{value:this.getAttribute("value")})})}},this);this.on("change",t)}else return r.onChange.apply(this,arguments);return null}},keyboardFocusable:!0},i,!0),CKEDITOR.ui.dialog.file.prototype=CKEDITOR.tools.extend(new CKEDITOR.ui.dialog.labeledElement,i,{getInputElement:function(){var n=CKEDITOR.document.getById(this._.frameId).getFrameDocument();return n.$.forms.length>0?new CKEDITOR.dom.element(n.$.forms[0].elements[0]):this.getElement()},submit:function(){return this.getInputElement().getParent().$.submit(),this},getAction:function(){return this.getInputElement().getParent().$.action},reset:function(){function r(){var r,u;for(n.$.open(),CKEDITOR.env.isCustomDomain()&&(n.$.domain=document.domain),r="",t.size&&(r=t.size-(CKEDITOR.env.ie?7:0)),n.$.write(['<html><head><title><\/title><\/head><body style="margin: 0; overflow: hidden; background: transparent;">','<form enctype="multipart/form-data" method="POST" action="',CKEDITOR.tools.htmlEncode(t.action),'">','<input type="file" name="',CKEDITOR.tools.htmlEncode(t.id||"cke_upload"),'" size="',CKEDITOR.tools.htmlEncode(r>0?r:""),'" />',"<\/form>","<\/body><\/html>"].join("")),n.$.close(),u=0;u<i.length;u++)i[u].enable()}var u=CKEDITOR.document.getById(this._.frameId),n=u.getFrameDocument(),t=this._.definition,i=this._.buttons;CKEDITOR.env.gecko?setTimeout(r,500):r()},getValue:function(){return""},eventProcessors:r,keyboardFocusable:!0},!0),CKEDITOR.ui.dialog.fileButton.prototype=new CKEDITOR.ui.dialog.button,CKEDITOR.dialog.addUIElement("text",f),CKEDITOR.dialog.addUIElement("password",f),CKEDITOR.dialog.addUIElement("textarea",t),CKEDITOR.dialog.addUIElement("checkbox",t),CKEDITOR.dialog.addUIElement("radio",t),CKEDITOR.dialog.addUIElement("button",t),CKEDITOR.dialog.addUIElement("select",t),CKEDITOR.dialog.addUIElement("file",t),CKEDITOR.dialog.addUIElement("fileButton",t),CKEDITOR.dialog.addUIElement("html",t)}();