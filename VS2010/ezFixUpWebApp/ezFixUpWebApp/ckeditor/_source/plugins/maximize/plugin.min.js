(function(){function t(n){var r,u,t,e,f,i;if(!n||n.type!=CKEDITOR.NODE_ELEMENT||n.getName()!="form")return[];for(r=[],u=["style","className"],t=0;t<u.length;t++)e=u[t],f=n.$.elements.namedItem(e),f&&(i=new CKEDITOR.dom.element(f),r.push([i,i.nextSibling]),i.remove());return r}function i(n,t){var i,r,u;if(n&&n.type==CKEDITOR.NODE_ELEMENT&&n.getName()=="form"&&t.length>0)for(i=t.length-1;i>=0;i--)r=t[i][0],u=t[i][1],u?r.insertBefore(u):r.appendTo(n)}function n(n,r){var e=t(n),f={},u=n.$;return r||(f["class"]=u.className||"",u.className=""),f.inline=u.style.cssText||"",r||(u.style.cssText="position: static; overflow: visible"),i(e),f}function r(n,r){var f=t(n),u=n.$;"class"in r&&(u.className=r["class"]),"inline"in r&&(u.style.cssText=r.inline),i(f)}function u(n,t){return function(){var i=n.getViewPaneSize();t.resize(i.width,i.height,null,!0)}}CKEDITOR.plugins.add("maximize",{init:function(t){var h=t.lang,s=CKEDITOR.document,i=s.getWindow(),f,e,o,c=u(i,t),l=CKEDITOR.TRISTATE_OFF;t.addCommand("maximize",{modes:{wysiwyg:1,source:1},editorFocus:!1,exec:function(){var a=t.container.getChild(0),w=t.getThemeSpace("contents"),b,v,u,k,d,p,y,tt;if(t.mode=="wysiwyg"?(b=t.getSelection(),f=b&&b.getRanges(),e=i.getScrollPosition()):(v=t.textarea.$,f=!CKEDITOR.env.ie&&[v.selectionStart,v.selectionEnd],e=[v.scrollLeft,v.scrollTop]),this.state==CKEDITOR.TRISTATE_OFF){i.on("resize",c);for(o=i.getScrollPosition(),u=t.container;u=u.getParent();)u.setCustomData("maximize_saved_styles",n(u)),u.setStyle("z-index",t.config.baseFloatZIndex-1);w.setCustomData("maximize_saved_styles",n(w,!0)),a.setCustomData("maximize_saved_styles",n(a,!0)),CKEDITOR.env.ie?s.$.documentElement.style.overflow=s.getBody().$.style.overflow="hidden":s.getBody().setStyles({overflow:"hidden",width:"0px",height:"0px"}),CKEDITOR.env.ie?setTimeout(function(){i.$.scrollTo(0,0)},0):i.$.scrollTo(0,0),k=i.getViewPaneSize(),a.setStyle("position","absolute"),a.$.offsetLeft,a.setStyles({"z-index":t.config.baseFloatZIndex-1,left:"0px",top:"0px"}),t.resize(k.width,k.height,null,!0),d=a.getDocumentPosition(),a.setStyles({left:-1*d.x+"px",top:-1*d.y+"px"}),a.addClass("cke_maximized")}else if(this.state==CKEDITOR.TRISTATE_ON){for(i.removeListener("resize",c),p=[w,a],y=0;y<p.length;y++)r(p[y],p[y].getCustomData("maximize_saved_styles")),p[y].removeCustomData("maximize_saved_styles");for(u=t.container;u=u.getParent();)r(u,u.getCustomData("maximize_saved_styles")),u.removeCustomData("maximize_saved_styles");CKEDITOR.env.ie?setTimeout(function(){i.$.scrollTo(o.x,o.y)},0):i.$.scrollTo(o.x,o.y),a.removeClass("cke_maximized"),t.fire("resize")}this.toggleState();var it=this.uiItems[0],g=this.state==CKEDITOR.TRISTATE_OFF?h.maximize:h.minimize,nt=t.element.getDocument().getById(it._.id);nt.getChild(1).setHtml(g),nt.setAttribute("title",g),nt.setAttribute("href",'javascript:void("'+g+'");'),t.mode=="wysiwyg"?f?(t.getSelection().selectRanges(f),tt=t.getSelection().getStartElement(),tt&&tt.scrollIntoView(!0)):i.$.scrollTo(e.x,e.y):(f&&(v.selectionStart=f[0],v.selectionEnd=f[1]),v.scrollLeft=e[0],v.scrollTop=e[1]),f=e=null,l=this.state},canUndo:!1}),t.ui.addButton("Maximize",{label:h.maximize,command:"maximize"});t.on("mode",function(){t.getCommand("maximize").setState(l)},null,null,100)}})})();