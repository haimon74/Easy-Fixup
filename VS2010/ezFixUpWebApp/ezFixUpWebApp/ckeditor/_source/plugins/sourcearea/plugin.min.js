CKEDITOR.plugins.add("sourcearea",{requires:["editingblock"],init:function(n){var t=CKEDITOR.plugins.sourcearea;n.on("editingBlockReady",function(){var t,i;n.addMode("source",{load:function(r,u){var f,e;if(CKEDITOR.env.ie&&CKEDITOR.env.version<8&&r.setStyle("position","relative"),n.textarea=t=new CKEDITOR.dom.element("textarea"),t.setAttributes({dir:"ltr",tabIndex:-1}),t.addClass("cke_source"),t.addClass("cke_enable_context_menu"),f={width:CKEDITOR.env.ie7Compat?"99%":"100%",height:"100%",resize:"none",outline:"none","text-align":"left"},CKEDITOR.env.ie){if(!CKEDITOR.env.ie8Compat){i=function(){t.hide(),t.setStyle("height",r.$.clientHeight+"px"),t.show()};n.on("resize",i);n.on("afterCommandExec",function(n){n.data.name=="toolbarCollapse"&&i()});f.height=r.$.clientHeight+"px"}}else t.on("mousedown",function(n){n.data.stopPropagation()});r.setHtml(""),r.append(t),t.setStyles(f);t.on("blur",function(){n.focusManager.blur()});t.on("focus",function(){n.focusManager.focus()});n.mayBeDirty=!0,this.loadData(u),e=n.keystrokeHandler,e&&e.attach(t),setTimeout(function(){n.mode="source",n.fire("mode")},CKEDITOR.env.gecko||CKEDITOR.env.webkit?100:0)},loadData:function(i){t.setValue(i),n.fire("dataReady")},getData:function(){return t.getValue()},getSnapshotData:function(){return t.getValue()},unload:function(r){n.textarea=t=null,i&&n.removeListener("resize",i),CKEDITOR.env.ie&&CKEDITOR.env.version<8&&r.removeStyle("position")},focus:function(){t.focus()}})});n.addCommand("source",t.commands.source),n.ui.addButton&&n.ui.addButton("Source",{label:n.lang.source,command:"source"});n.on("mode",function(){n.getCommand("source").setState(n.mode=="source"?CKEDITOR.TRISTATE_ON:CKEDITOR.TRISTATE_OFF)})}}),CKEDITOR.plugins.sourcearea={commands:{source:{modes:{wysiwyg:1,source:1},exec:function(n){n.mode=="wysiwyg"&&n.fire("saveSnapshot"),n.getCommand("source").setState(CKEDITOR.TRISTATE_DISABLED),n.setMode(n.mode=="source"?"wysiwyg":"source")},canUndo:!1}}};