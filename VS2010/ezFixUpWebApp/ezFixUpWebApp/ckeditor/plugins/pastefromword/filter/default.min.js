(function(){var u=CKEDITOR.htmlParser.fragment.prototype,n=CKEDITOR.htmlParser.element.prototype,r;u.onlyChild=n.onlyChild=function(){var n=this.children,t=n.length,i=t==1&&n[0];return i||null},n.removeAnyChildWithName=function(n){for(var u=this.children,r=[],t,i=0;i<u.length;i++)(t=u[i],t.name)&&(t.name==n&&(r.push(t),u.splice(i--,1)),r=r.concat(t.removeAnyChildWithName(n)));return r},n.getAncestor=function(n){for(var t=this.parent;t&&!(t.name&&t.name.match(n));)t=t.parent;return t},u.firstChild=n.firstChild=function(n){for(var t,i=0;i<this.children.length;i++){if(t=this.children[i],n(t))return t;if(t.name){if(t=t.firstChild(n),t)return t;continue}}return null},n.addStyle=function(n,t,i){var f=this,r,u="",e;if(typeof t=="string")u+=n+":"+t+";";else{if(typeof n=="object")for(e in n)n.hasOwnProperty(e)&&(u+=e+":"+n[e]+";");else u+=n;i=t}f.attributes||(f.attributes={}),r=f.attributes.style||"",r=(i?[u,r]:[r,u]).join(";"),f.attributes.style=r.replace(/^;|;(?=;)/,"")},CKEDITOR.dtd.parentOf=function(n){var i={},t;for(t in this)t.indexOf("$")==-1&&this[t][n]&&(i[t]=1);return i};var e=/^(\d[.\d]*)+(em|ex|px|gd|rem|vw|vh|vm|ch|mm|cm|in|pt|pc|deg|rad|ms|s|hz|khz){1}?/i,f=/^(?:\b0[^\s]*\s*){1,4}$/,t=0,i;CKEDITOR.plugins.pastefromword={utils:{createListBulletMarker:function(n,t){var r=new CKEDITOR.htmlParser.element("cke:listbullet"),i;return n?n[2]?(n=isNaN(n[1])?/^[a-z]+$/.test(n[1])?"lower-alpha":/^[A-Z]+$/.test(n[1])?"upper-alpha":"decimal":"decimal",i="ol"):(n=/[l\u00B7\u2002]/.test(n[1])?"disc":/[\u006F\u00D8]/.test(n[1])?"circle":/[\u006E\u25C6]/.test(n[1])?"square":"disc",i="ul"):(n="decimal",i="ol"),r.attributes={"cke:listtype":i,style:"list-style-type:"+n+";"},r.add(new CKEDITOR.htmlParser.text(t)),r},isListBulletIndicator:function(n){var t=n.attributes&&n.attributes.style;if(/mso-list\s*:\s*Ignore/i.test(t))return!0},isContainingOnlySpaces:function(n){var t;return(t=n.onlyChild())&&/^(:?\s|&nbsp;)+$/.test(t.value)},resolveList:function(n){var o=n.children,r=n.attributes,u,f,e;return(u=n.removeAnyChildWithName("cke:listbullet"))&&u.length&&(u=u[0])?(n.name="cke:li",r.style&&(r.style=CKEDITOR.plugins.pastefromword.filters.stylesFilter([["text-indent"],["line-height"],[/^margin(:?-left)?$/,null,function(n){var u=n.split(" ");n=u[3]||u[1]||u[0],n=parseInt(n,10),!t&&i&&n>i&&(t=n-i),r["cke:margin"]=i=n}]])(r.style,n)||""),f=u.attributes,e=f.style,n.addStyle(e),CKEDITOR.tools.extend(r,f),!0):!1},convertToPx:function(){var n=CKEDITOR.dom.element.createFromHtml('<div style="position:absolute;left:-9999px;top:-9999px;margin:0px;padding:0px;border:0px;"><\/div>',CKEDITOR.document);return CKEDITOR.document.getBody().append(n),function(t){return e.test(t)?(n.setStyle("width",t),n.$.clientWidth+"px"):t}}(),getStyleComponents:function(){var n=CKEDITOR.dom.element.createFromHtml('<div style="position:absolute;left:-9999px;top:-9999px;"><\/div>',CKEDITOR.document);return CKEDITOR.document.getBody().append(n),function(t,i,r){var f,e,u;for(n.setStyle(t,i),f={},e=r.length,u=0;u<e;u++)f[r[u]]=n.getStyle(r[u]);return f}}(),listDtdParents:CKEDITOR.dtd.parentOf("ol")},filters:{flattenList:function(n){for(var c=n.attributes,u=n.parent,e,l=1,f,t,r,o;u;)u.attributes&&u.attributes["cke:list"]&&l++,u=u.parent;switch(c.type){case"a":e="lower-alpha"}for(f=n.children,r=0;r<f.length;r++)if(t=f[r],o=t.attributes,t.name in CKEDITOR.dtd.$listItem){var s=t.children,a=s.length,h=s[a-1];h.name in CKEDITOR.dtd.$list&&(f.splice(r+1,0,h),h.parent=n,--s.length||f.splice(r,1)),t.name="cke:li",o["cke:indent"]=l,i=0,o["cke:listtype"]=n.name,e&&t.addStyle("list-style-type",e,!0)}delete n.name,c["cke:list"]=1},assembleList:function(n){for(var o=n.children,s,r,u,h,e,a,i,c,v,l,f=0;f<o.length;f++)if(s=o[f],"cke:li"==s.name){if(s.name="li",r=s,u=r.attributes,h=r.attributes["cke:listtype"],e=parseInt(u["cke:indent"],10)||t&&Math.ceil(u["cke:margin"]/t)||1,u.style&&(u.style=CKEDITOR.plugins.pastefromword.filters.stylesFilter([["list-style-type",h=="ol"?"decimal":"disc"]])(u.style)||""),i){if(e>c)i=new CKEDITOR.htmlParser.element(h),i.add(r),a.add(i);else if(e<c){for(v=c-e,l=i.parent;v--&&l;)i=l.parent;i.add(r)}else i.add(r);o.splice(f--,1)}else i=new CKEDITOR.htmlParser.element(h),i.add(r),o[f]=i;a=r,c=e}else i=null;t=0},falsyFilter:function(){return!1},stylesFilter:function(n,t){return function(i,r){var u=[],f;for(i.replace(/&quot;/g,'"').replace(/\s*([^ :;]+)\s*:\s*([^;]+)\s*(?=;|$)/g,function(i,f,e){var c,h,o,l,s;for(f=f.toLowerCase(),f=="font-family"&&(e=e.replace(/["']/g,"")),s=0;s<n.length;s++)if(n[s]&&(c=n[s][0],h=n[s][1],o=n[s][2],l=n[s][3],f.match(c)&&(!h||e.match(h)))){f=l||f,t&&(o=o||e),typeof o=="function"&&(o=o(e,r,f)),o&&o.push&&(f=o[0],o=o[1]),typeof o=="string"&&u.push([f,o]);return}t||u.push([f,e])}),f=0;f<u.length;f++)u[f]=u[f].join(":");return u.length?u.join(";")+";":!1}},elementMigrateFilter:function(n,t){return function(i){var r=t?new CKEDITOR.style(n,t)._.definition:n;i.name=r.element,CKEDITOR.tools.extend(i.attributes,CKEDITOR.tools.clone(r.attributes)),i.addStyle(CKEDITOR.style.getStyleText(r))}},styleMigrateFilter:function(n,t){var i=this.elementMigrateFilter;return function(r,u){var f=new CKEDITOR.htmlParser.element(null),e={};e[t]=r,i(n,e)(f),f.children=u.children,u.children=[f]}},bogusAttrFilter:function(n,t){if(t.name.indexOf("cke:")==-1)return!1},applyStyleFilter:null},getRules:function(n){var u=CKEDITOR.dtd,b=CKEDITOR.tools.extend({},u.$block,u.$listItem,u.$tableContent),t=n.config,i=this.filters,o=i.falsyFilter,h=i.stylesFilter,r=i.elementMigrateFilter,s=CKEDITOR.tools.bind(this.filters.styleMigrateFilter,this.filters),nt=i.bogusAttrFilter,v=this.utils.createListBulletMarker,c=i.flattenList,y=i.assembleList,l=this.utils.isListBulletIndicator,p=this.utils.isContainingOnlySpaces,w=this.utils.resolveList,k=this.utils.convertToPx,d=this.utils.getStyleComponents,g=this.utils.listDtdParents,e=t.pasteFromWordRemoveFontStyles!==!1,a=t.pasteFromWordRemoveStyles!==!1;return{elementNames:[[/meta|link|script/,""]],root:function(n){n.filterChildren(),y(n)},elements:{"^":function(n){var t;CKEDITOR.env.gecko&&(t=i.applyStyleFilter)&&t(n)},$:function(n){var i=n.name||"",f=n.attributes,e;if(i in b&&f.style&&(f.style=h([[/^(:?width|height)$/,null,k]])(f.style)||""),i.match(/h\d/)){if(n.filterChildren(),w(n))return;r(t["format_"+i])(n)}else if(i in u.$inline)n.filterChildren(),p(n)&&delete n.name;else if(i.indexOf(":")!=-1&&i.indexOf("cke")==-1){if(n.filterChildren(),i=="v:imagedata"){e=n.attributes["o:href"],e&&(n.attributes.src=e),n.name="img";return}delete n.name}i in g&&(n.filterChildren(),y(n))},style:function(n){if(CKEDITOR.env.gecko){var r=n.onlyChild().value.match(/\/\* Style Definitions \*\/([\s\S]*?)\/\*/),u=r&&r[1],t={};u&&(u.replace(/[\n\r]/g,"").replace(/(.+?)\{(.+?)\}/g,function(n,i,r){var f,u;for(i=i.split(","),f=i.length,u=0;u<f;u++)CKEDITOR.tools.trim(i[u]).replace(/^(\w+)(\.[\w-]+)?$/g,function(n,i,u){(i=i||"*",u=u.substring(1,u.length),u.match(/MsoNormal/))||(t[i]||(t[i]={}),u?t[i][u]=r:t[i]=r)})}),i.applyStyleFilter=function(n){var r=t["*"]?"*":n.name,u=n.attributes&&n.attributes["class"],i;r in t&&(i=t[r],typeof i=="object"&&(i=i[u]),i&&n.addStyle(i,!0))})}return!1},p:function(n){n.filterChildren();var i=n.attributes,u=n.parent,f=n.children;w(n)||(t.enterMode==CKEDITOR.ENTER_BR?(delete n.name,n.add(new CKEDITOR.htmlParser.element("br"))):r(t["format_"+(t.enterMode==CKEDITOR.ENTER_P?"p":"div")])(n))},div:function(n){var t=n.onlyChild(),i,r;t&&t.name=="table"&&(i=n.attributes,t.attributes=CKEDITOR.tools.extend(t.attributes,i),i.style&&t.addStyle(i.style),r=new CKEDITOR.htmlParser.element("div"),r.addStyle("clear","both"),n.add(r),delete n.name)},td:function(n){n.getAncestor("thead")&&(n.name="th")},ol:c,ul:c,dl:c,font:function(n){if(!CKEDITOR.env.gecko&&l(n.parent)){delete n.name;return}n.filterChildren();var t=n.attributes,i=t.style,r=n.parent;if("font"==r.name){CKEDITOR.tools.extend(r.attributes,n.attributes),i&&r.addStyle(i),delete n.name;return}i=i||"",t.color&&(t.color!="#000000"&&(i+="color:"+t.color+";"),delete t.color),t.face&&(i+="font-family:"+t.face+";",delete t.face),t.size&&(i+="font-size:"+(t.size>3?"large":t.size<3?"small":"medium")+";",delete t.size),n.name="span",n.addStyle(i)},span:function(n){if(!CKEDITOR.env.gecko&&l(n.parent))return!1;if(n.filterChildren(),p(n))return delete n.name,null;if(!CKEDITOR.env.gecko&&l(n)){var r=n.firstChild(function(n){return n.value||n.name=="img"}),u=r&&(r.value||"l."),c=u.match(/^([^\s]+?)([.)]?)$/);return v(c,u)}var f=n.children,i=n.attributes,o=i&&i.style,a=f&&f[0];return o&&(i.style=h([["line-height"],[/^font-family$/,null,e?null:s(t.font_style,"family")],[/^font-size$/,null,e?null:s(t.fontSize_style,"size")],[/^color$/,null,e?null:s(t.colorButton_foreStyle,"color")],[/^background-color$/,null,e?null:s(t.colorButton_backStyle,"color")]])(o,n)||""),null},b:r(t.coreStyles_bold),i:r(t.coreStyles_italic),u:r(t.coreStyles_underline),s:r(t.coreStyles_strike),sup:r(t.coreStyles_superscript),sub:r(t.coreStyles_subscript),a:function(n){var t=n.attributes;t&&!t.href&&t.name&&delete n.name},"cke:listbullet":function(n){n.getAncestor(/h\d/)&&!t.pasteFromWordNumberedHeadingToList&&delete n.name}},attributeNames:[[/^onmouse(:?out|over)/,""],[/^onload$/,""],[/(?:v|o):\w+/,""],[/^lang/,""]],attributes:{style:h(a?[[/^margin$|^margin-(?!bottom|top)/,null,function(n,i,r){if(i.name in{p:1,div:1}){var u=t.contentsLangDirection=="ltr"?"margin-left":"margin-right";if(r=="margin")n=d(r,n,[u])[u];else if(r!=u)return null;if(n&&!f.test(n))return[u,n]}return null}],[/^clear$/],[/^border.*|margin.*|vertical-align|float$/,null,function(n,t){if(t.name=="img")return n}],[/^width|height$/,null,function(n,t){if(t.name in{table:1,td:1,th:1,img:1})return n}]]:[[/^mso-/],[/-color$/,null,function(n){return n=="transparent"?!1:CKEDITOR.env.gecko?n.replace(/-moz-use-text-color/g,"transparent"):void 0}],[/^margin$/,f],["text-indent","0cm"],["page-break-before"],["tab-stops"],["display","none"],e?[/font-?/]:null],a),width:function(n,t){if(t.name in u.$tableContent)return!1},border:function(n,t){if(t.name in u.$tableContent)return!1},"class":o,bgcolor:o,valign:a?o:function(n,t){return t.addStyle("vertical-align",n),!1}},comment:CKEDITOR.env.ie?o:function(n,t){var r=n.match(/<img.*?>/),u=n.match(/^\[if !supportLists\]([\s\S]*?)\[endif\]$/),i,f;if(u)return i=u[1]||r&&"l.",f=i&&i.match(/>([^\s]+?)([.)]?)</),v(f,i);if(CKEDITOR.env.gecko&&r){var e=CKEDITOR.htmlParser.fragment.fromHtml(r[0]).children[0],o=t.previous,s=o&&o.value.match(/<v:imagedata[^>]*o:href=['"](.*?)['"]/),h=s&&s[1];return h&&(e.attributes.src=h),e}return!1}}}},r=function(){this.dataFilter=new CKEDITOR.htmlParser.filter},r.prototype={toHtml:function(n){var i=CKEDITOR.htmlParser.fragment.fromHtml(n,!1),t=new CKEDITOR.htmlParser.basicWriter;return i.writeHtml(t,this.dataFilter),t.getHtml(!0)}},CKEDITOR.cleanWord=function(n,t){CKEDITOR.env.gecko&&(n=n.replace(/(<!--\[if[^<]*?\])-->([\S\s]*?)<!--(\[endif\]-->)/gi,"$1$2$3"));var i=new r,u=i.dataFilter;u.addRules(CKEDITOR.plugins.pastefromword.getRules(t)),t.fire("beforeCleanWord",{filter:u});try{n=i.toHtml(n,!1)}catch(f){alert(t.lang.pastefromword.error)}return n=n.replace(/cke:.*?".*?"/g,""),n=n.replace(/style=""/g,""),n.replace(/<span>/g,"")}})();