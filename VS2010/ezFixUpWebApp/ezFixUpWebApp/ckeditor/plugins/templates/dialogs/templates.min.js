(function(){function i(i,u){var o=n.getById(t),f,e,c;for(o.setHtml(""),f=0;f<u.length;f++){var s=CKEDITOR.getTemplates(u[f]),l=s.imagesPath,h=s.templates;for(e=0;e<h.length;e++)c=h[e],o.append(r(i,c,l))}}function r(t,i,r){var f=n.createElement("div"),e;f.setAttribute("class","cke_tpl_item"),e='<table style="width:350px;" class="cke_tpl_preview"><tr>',i.image&&r&&(e+='<td class="cke_tpl_preview_img"><img src="'+CKEDITOR.getUrl(r+i.image)+'"><\/td>'),e+='<td style="white-space:normal;"><span class="cke_tpl_title">'+i.title+"<\/span><br/>",i.description&&(e+="<span>"+i.description+"<\/span>"),e+="<\/td><\/tr><\/table>",f.setHtml(e);f.on("mouseover",function(){f.addClass("cke_tpl_hover")});f.on("mouseout",function(){f.removeClass("cke_tpl_hover")});f.on("click",function(){u(t,i.html)});return f}function u(n,t){var i=CKEDITOR.dialog.getCurrent(),r=i.getValueOf("selectTpl","chkInsertOpt");if(r){n.on("contentDom",function(t){t.removeListener(),i.hide();var r=new CKEDITOR.dom.range(n.document);r.moveToElementEditStart(n.document.getBody()),r.select(!0)});n.setData(t)}else n.insertHtml(t),i.hide()}var n=CKEDITOR.document,t="cke"+CKEDITOR.tools.getNextNumber();CKEDITOR.dialog.add("templates",function(r){CKEDITOR.skins.load(r,"templates");return{title:r.lang.templates.title,minWidth:CKEDITOR.env.ie?440:400,minHeight:340,contents:[{id:"selectTpl",label:r.lang.templates.title,elements:[{type:"vbox",padding:5,children:[{type:"html",html:"<span>"+r.lang.templates.selectPromptMsg+"<\/span>"},{type:"html",html:'<div id="'+t+'" class="cke_tpl_list"><div class="cke_tpl_loading"><span><\/span><\/div><\/div>'},{id:"chkInsertOpt",type:"checkbox",label:r.lang.templates.insertOption,"default":r.config.templates_replaceContent}]}]}],buttons:[CKEDITOR.dialog.cancelButton],onShow:function(){CKEDITOR.loadTemplates(r.config.templates_files,function(){var u=r.config.templates.split(","),f;u.length?i(r,u):(f=n.getById(t),f.setHtml('<div class="cke_tpl_empty"><span>'+r.lang.templates.emptyListMsg+"<\/span><\/div>"))})}}})})();