(function(){CKEDITOR.config.jqueryOverrideVal=typeof CKEDITOR.config.jqueryOverrideVal=="undefined"?!0:CKEDITOR.config.jqueryOverrideVal;var n=window.jQuery;typeof n!="undefined"&&(n.extend(n.fn,{ckeditorGet:function(){var n=this.eq(0).data("ckeditorInstance");if(!n)throw"CKEditor not yet initialized, use ckeditor() with callback.";return n},ckeditor:function(t,i){if(!n.isFunction(t)){var r=i;i=t,t=r}return i=i||{},this.filter("textarea, div, p").each(function(){var r=n(this),u=r.data("ckeditorInstance"),e=r.data("_ckeditorInstanceLock"),f=this;if(u&&!e)t&&t.apply(u,[this]);else if(e)CKEDITOR.on("instanceReady",function(n){var i=n.editor;setTimeout(function(){if(!i.element){setTimeout(arguments.callee,100);return}i.element.$==f&&t&&t.apply(i,[f])},0)},null,null,9999);else{(i.autoUpdateElement||typeof i.autoUpdateElement=="undefined"&&CKEDITOR.config.autoUpdateElement)&&(i.autoUpdateElementJquery=!0),i.autoUpdateElement=!1,r.data("_ckeditorInstanceLock",!0),u=CKEDITOR.replace(f,i),r.data("ckeditorInstance",u);u.on("instanceReady",function(n){var i=n.editor;setTimeout(function(){if(!i.element){setTimeout(arguments.callee,100);return}n.removeListener("instanceReady",this.callee);i.on("dataReady",function(){r.trigger("setData.ckeditor",[i])});i.on("getData",function(n){r.trigger("getData.ckeditor",[i,n.data])},999);i.on("destroy",function(){r.trigger("destroy.ckeditor",[i])});if(i.config.autoUpdateElementJquery&&r.is("textarea")&&r.parents("form").length){var u=function(){r.ckeditor(function(){i.updateElement()})};r.parents("form").submit(u),r.bind("destroy.ckeditor",function(){r.parents("form").unbind("submit",u)})}i.on("destroy",function(){r.data("ckeditorInstance",null)});r.data("_ckeditorInstanceLock",null),r.trigger("instanceReady.ckeditor",[i]),t&&t.apply(i,[f])},0)},null,null,9999)}}),this}}),CKEDITOR.config.jqueryOverrideVal&&(n.fn.val=CKEDITOR.tools.override(n.fn.val,function(t){return function(i,r){var u=typeof i!="undefined",f;return this.each(function(){var e=n(this),o=e.data("ckeditorInstance");if(!r&&e.is("textarea")&&o)if(u)o.setData(i);else return f=o.getData(),null;else if(u)t.call(e,i);else return f=t.call(e),null;return!0}),u?this:f}})))})();