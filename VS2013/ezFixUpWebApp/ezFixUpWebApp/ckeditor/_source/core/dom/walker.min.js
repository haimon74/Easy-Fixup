(function(){function n(n,t){var e,o,s,h,c;if(this._.end)return null;var i,r=this.range,u,l=this.guard,f=this.type,a=n?"getPreviousSourceNode":"getNextSourceNode";if(!this._.start&&(this._.start=1,r.trim(),r.collapsed))return this.end(),null;for(n||this._.guardLTR||(e=r.endContainer,o=e.getChild(r.endOffset),this._.guardLTR=function(n,t){return(!t||!e.equals(n))&&(!o||!n.equals(o))&&(n.type!=CKEDITOR.NODE_ELEMENT||!t||n.getName()!="body")}),n&&!this._.guardRTL&&(s=r.startContainer,h=r.startOffset>0&&s.getChild(r.startOffset-1),this._.guardRTL=function(n,t){return(!t||!s.equals(n))&&(!h||!n.equals(h))&&(n.type!=CKEDITOR.NODE_ELEMENT||!t||n.getName()!="body")}),c=n?this._.guardRTL:this._.guardLTR,u=l?function(n,t){return c(n,t)===!1?!1:l(n,t)}:c,this.current?i=this.current[a](!1,f,u):n?(i=r.endContainer,r.endOffset>0?(i=i.getChild(r.endOffset-1),u(i)===!1&&(i=null)):i=u(i)===!1?null:i.getPreviousSourceNode(!0,f,u)):(i=r.startContainer,i=i.getChild(r.startOffset),i?u(i)===!1&&(i=null):i=u(r.startContainer)===!1?null:r.startContainer.getNextSourceNode(!0,f,u));i&&!this._.end;){if(this.current=i,this.evaluator&&this.evaluator(i)===!1){if(t&&this.evaluator)return!1}else if(!t)return i;i=i[a](!1,f,u)}return this.end(),this.current=null}function t(t){for(var i,r=null;i=n.call(this,t);)r=i;return r}var i,r;CKEDITOR.dom.walker=CKEDITOR.tools.createClass({$:function(n){this.range=n,this._={}},proto:{end:function(){this._.end=1},next:function(){return n.call(this)},previous:function(){return n.call(this,!0)},checkForward:function(){return n.call(this,!1,!0)!==!1},checkBackward:function(){return n.call(this,!0,!0)!==!1},lastForward:function(){return t.call(this)},lastBackward:function(){return t.call(this,!0)},reset:function(){delete this.current,this._={}}}}),i={block:1,"list-item":1,table:1,"table-row-group":1,"table-header-group":1,"table-footer-group":1,"table-row":1,"table-column-group":1,"table-column":1,"table-cell":1,"table-caption":1},r={hr:1},CKEDITOR.dom.element.prototype.isBlockBoundary=function(n){var t=CKEDITOR.tools.extend({},r,n||{});return i[this.getComputedStyle("display")]||t[this.getName()]},CKEDITOR.dom.walker.blockBoundary=function(n){return function(t){return!(t.type==CKEDITOR.NODE_ELEMENT&&t.isBlockBoundary(n))}},CKEDITOR.dom.walker.listItemBoundary=function(){return this.blockBoundary({br:1})},CKEDITOR.dom.walker.bookmarkContents=function(){},CKEDITOR.dom.walker.bookmark=function(n,t){function i(n){return n&&n.getName&&n.getName()=="span"&&n.hasAttribute("_fck_bookmark")}return function(r){var u,f;return u=r&&!r.getName&&(f=r.getParent())&&i(f),u=n?u:u||i(r),t^u}},CKEDITOR.dom.walker.whitespaces=function(n){return function(t){var i=t&&t.type==CKEDITOR.NODE_TEXT&&!CKEDITOR.tools.trim(t.getText());return n^i}},CKEDITOR.dom.walker.invisible=function(n){var t=CKEDITOR.dom.walker.whitespaces();return function(i){var r=t(i)||i.is&&!i.$.offsetHeight;return n^r}};var u=/^[\t\r\n ]*(?:&nbsp;|\xa0)$/,f=CKEDITOR.dom.walker.whitespaces(!0),e=CKEDITOR.dom.walker.bookmark(!1,!0),o=function(n){return e(n)&&f(n)};CKEDITOR.dom.element.prototype.getBogus=function(){var n=this.getLast(o);return n&&(CKEDITOR.env.ie?n.getText&&u.test(n.getText()):n.is&&n.is("br"))?n:!1}})();