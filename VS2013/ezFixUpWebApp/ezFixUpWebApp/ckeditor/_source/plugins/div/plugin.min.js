(function(){CKEDITOR.plugins.add("div",{requires:["editingblock","domiterator"],init:function(n){var t=n.lang.div;n.addCommand("creatediv",new CKEDITOR.dialogCommand("creatediv")),n.addCommand("editdiv",new CKEDITOR.dialogCommand("editdiv")),n.addCommand("removediv",{exec:function(n){function o(n){var r=new CKEDITOR.dom.elementPath(n),i=r.blockLimit,t=i.is("div")&&i;t&&!t.getAttribute("_cke_div_added")&&(f.push(t),t.setAttribute("_cke_div_added"))}for(var i=n.getSelection(),e=i&&i.getRanges(),r,s=i.createBookmarks(),u,f=[],t=0;t<e.length;t++)r=e[t],r.collapsed?o(i.getStartElement()):(u=new CKEDITOR.dom.walker(r),u.evaluator=o,u.lastForward());for(t=0;t<f.length;t++)f[t].remove(!0);i.selectBookmarks(s)}}),n.ui.addButton("CreateDiv",{label:t.toolbar,command:"creatediv"}),n.addMenuItems&&(n.addMenuItems({editdiv:{label:t.edit,command:"editdiv",group:"div",order:1},removediv:{label:t.remove,command:"removediv",group:"div",order:5}}),n.contextMenu&&n.contextMenu.addListener(function(n){if(!n)return null;var i=new CKEDITOR.dom.elementPath(n),t=i.blockLimit;return t&&t.getAscendant("div",!0)?{editdiv:CKEDITOR.TRISTATE_OFF,removediv:CKEDITOR.TRISTATE_OFF}:null})),CKEDITOR.dialog.add("creatediv",this.path+"dialogs/div.js"),CKEDITOR.dialog.add("editdiv",this.path+"dialogs/div.js")}})})();