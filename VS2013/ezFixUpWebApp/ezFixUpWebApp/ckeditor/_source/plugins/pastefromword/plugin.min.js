(function(){CKEDITOR.plugins.add("pastefromword",{init:function(n){var t=0,i=function(){setTimeout(function(){t=0},0)};n.addCommand("pastefromword",{canUndo:!1,exec:function(){if(t=1,n.execCommand("paste")===!1)n.on("dialogHide",function(n){n.removeListener(),i()})}}),n.ui.addButton("PasteFromWord",{label:n.lang.pastefromword.toolbar,command:"pastefromword"});n.on("paste",function(i){var r=i.data,u,f;(u=r.html)&&(t||/(class=\"?Mso|style=\"[^\"]*\bmso\-|w:WordDocument)/.test(u))&&(f=this.loadFilterRules(function(){f?n.fire("paste",r):(!n.config.pasteFromWordPromptCleanup||t||confirm(n.lang.pastefromword.confirmCleanup))&&(r.html=CKEDITOR.cleanWord(u,n))}),f&&i.cancel())},this)},loadFilterRules:function(n){var t=CKEDITOR.cleanWord,i;return t?n():(i=CKEDITOR.getUrl(CKEDITOR.config.pasteFromWordCleanupFile||this.path+"filter/default.js"),CKEDITOR.scriptLoader.load(i,n,null,!1,!0)),!t}})})();