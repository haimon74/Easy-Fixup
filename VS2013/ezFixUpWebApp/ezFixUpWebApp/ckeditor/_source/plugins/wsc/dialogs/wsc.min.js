CKEDITOR.dialog.add("checkspell",function(n){function c(n,t){var i=0;return function(){typeof window.doSpell=="function"?(typeof f!="undefined"&&window.clearInterval(f),l(n)):i++==180&&window._cancelOnError(t)}}function l(i){var f=new window._SP_FCK_LangCompare,e=CKEDITOR.getUrl(n.plugins.wsc.path+"dialogs/"),o=e+"tmpFrameset.html";window.gFCKPluginName="wsc",f.setDefaulLangCode(n.config.defaultLanguage),window.doSpell({ctrl:r,lang:n.config.wsc_lang||f.getSPLangCode(n.langCode),intLang:n.config.wsc_uiLang||f.getSPLangCode(n.langCode),winType:t,onCancel:function(){i.hide()},onFinish:function(t){n.focus(),i.getParentEditor().setData(t.value),i.hide()},staticFrame:o,framesetPath:o,iframePath:e+"ciframe.html",schemaURI:e+"wsc.css",userDictionaryName:n.config.wsc_userDictionaryName,customDictionaryName:n.config.wsc_customDictionaryIds&&n.config.wsc_customDictionaryIds.split(","),domainName:n.config.wsc_domainName}),CKEDITOR.document.getById(u).setStyle("display","none"),CKEDITOR.document.getById(t).setStyle("display","block")}var i=CKEDITOR.tools.getNextNumber(),t="cke_frame_"+i,r="cke_data_"+i,u="cke_error_"+i,f,o=document.location.protocol||"http:",e=n.lang.spellCheck.notAvailable,s='<textarea style="display: none" id="'+r+'" rows="10" cols="40"> <\/textarea><div id="'+u+'" style="display:none;color:red;font-size:16px;font-weight:bold;padding-top:160px;text-align:center;z-index:11;"><\/div><iframe src="" style="width:485px;background-color:#f1f1e3;height:380px" frameborder="0" name="'+t+'" id="'+t+'" allowtransparency="1"><\/iframe>',h=n.config.wsc_customLoaderScript||o+"//loader.spellchecker.net/sproxy_fck/sproxy.php?plugin=fck2&customerid="+n.config.wsc_customerId+"&cmd=script&doc=wsc&schema=22";return n.config.wsc_customLoaderScript&&(e+='<p style="color:#000;font-size:11px;font-weight: normal;text-align:center;padding-top:10px">'+n.lang.spellCheck.errorLoading.replace(/%s/g,n.config.wsc_customLoaderScript)+"<\/p>"),window._cancelOnError=function(i){if(typeof window.WSC_Error=="undefined"){CKEDITOR.document.getById(t).setStyle("display","none");var r=CKEDITOR.document.getById(u);r.setStyle("display","block"),r.setHtml(i||n.lang.spellCheck.notAvailable)}},{title:n.config.wsc_dialogTitle||n.lang.spellCheck.title,minWidth:485,minHeight:380,buttons:[CKEDITOR.dialog.cancelButton],onShow:function(){var i=this.getContentElement("general","content").getElement(),t;i.setHtml(s),typeof window.doSpell!="function"&&CKEDITOR.document.getHead().append(CKEDITOR.document.createElement("script",{attributes:{type:"text/javascript",src:h}})),t=n.getData(),CKEDITOR.document.getById(r).setValue(t),f=window.setInterval(c(this,e),250)},onHide:function(){window.ooo=undefined,window.int_framsetLoaded=undefined,window.framesetLoaded=undefined,window.is_window_opened=!1},contents:[{id:"general",label:n.config.wsc_dialogTitle||n.lang.spellCheck.title,padding:0,elements:[{type:"html",id:"content",style:"width:485;height:380px",html:"<div><\/div>"}]}]}});